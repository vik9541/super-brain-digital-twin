# ü§ñ BOT SETUP & TESTING GUIDE

**–î–∞—Ç–∞:** 8 –¥–µ–∫–∞–±—Ä—è 2025, 09:00 –ú–°–ö
**–ë–æ—Ç:** @digitaltwin2025_bot
**–¢–æ–∫–µ–Ω:** `8326941950:AAHxjtILMo9qgPjm1Ii8CSsIZMLSp3B2oVE`

---

## ‚úÖ –°–¢–ê–¢–£–° –ó–ê–í–ï–†–®–ï–ù–ò–Ø PHASE 3

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- ‚úÖ `api/bot_handler.py` (400+ —Å—Ç—Ä–æ–∫) - –û—Å–Ω–æ–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –±–æ—Ç–∞
- ‚úÖ `api/webhook_handler.py` (300+ —Å—Ç—Ä–æ–∫) - FastAPI webhook —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ `api/message_router.py` (200+ —Å—Ç—Ä–æ–∫) - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ `api/error_handler.py` (200+ —Å—Ç—Ä–æ–∫) - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ `k8s/bot-deployment.yaml` (50+ —Å—Ç—Ä–æ–∫) - Kubernetes –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç
- ‚úÖ `PHASE-3-COMPLETION-REPORT.md` - –û—Ç—á–µ—Ç –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã:
- ‚úÖ bot_handler.py (—Å—Ç—Ä–æ–∫–∞ 19)
- ‚úÖ webhook_handler.py (—Å—Ç—Ä–æ–∫–∞ 19)
- ‚úÖ error_handler.py (—Å—Ç—Ä–æ–∫–∞ 21)

**–ü—Ä–æ–≥—Ä–µ—Å—Å:** 95% ‚úÖ  
**–°—Ç–∞—Ç—É—Å:** READY FOR TESTING üü¢

---

## üìã –®–ê–ì 1: –ù–ê–°–¢–†–û–ô–ö–ê –ö–û–ú–ê–ù–î –í @BotFather

### 1.1 –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ @BotFather

### 1.2 –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—ã:

```
/mybots
```

### 1.3 –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –±–æ—Ç:
- –ù–∞–∂–º–∏—Ç–µ –Ω–∞: **Digital Twin Bot** (@digitaltwin2025_bot)

### 1.4 –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã:
1. –ù–∞–∂–º–∏—Ç–µ: **Edit Bot**
2. –ù–∞–∂–º–∏—Ç–µ: **Edit Commands**
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π —Ç–µ–∫—Å—Ç:

```
start - üëã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
ask - üí¨ –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å Perplexity AI
analyze - üìä –ü–æ–ª—É—á–∏—Ç—å –¥–Ω–µ–≤–Ω–æ–π –∞–Ω–∞–ª–∏–∑
report - üìà –ü–æ–ª—É—á–∏—Ç—å –ø–æ—á–∞—Å–æ–≤–æ–π –æ—Ç—á–µ—Ç
help - ‚ùì –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
status - üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
```

### 1.5 –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ
- @BotFather –æ—Ç–≤–µ—Ç–∏—Ç: "Success! Command list updated."

---

## üß™ –®–ê–ì 2: –õ–û–ö–ê–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### 2.1 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã):

```bash
pip install python-telegram-bot fastapi pydantic httpx asyncio
```

### 2.2 –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
cd /path/to/super-brain-digital-twin
python api/bot_handler.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
‚úÖ Bot initialized successfully
üöÄ Bot started and listening for messages
ü§ñ Bot username: @digitaltwin2025_bot
```

### 2.3 –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ:

1. **–ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞:** [@digitaltwin2025_bot](https://t.me/digitaltwin2025_bot)

2. **–¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

```
/start
```
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

```
/help
```
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

```
/ask –ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?
```
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** –û—Ç–≤–µ—Ç –æ—Ç Perplexity AI —á–µ—Ä–µ–∑ n8n workflow

```
/status
```
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º (FastAPI, n8n, Perplexity)

```
/analyze
```
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** –î–Ω–µ–≤–Ω–æ–π –∞–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

```
/report
```
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** –ü–æ—á–∞—Å–æ–≤–æ–π –æ—Ç—á–µ—Ç

---

## üê≥ –®–ê–ì 3: KUBERNETES DEPLOYMENT

### 3.1 –°–æ–∑–¥–∞–π—Ç–µ Secret –¥–ª—è —Ç–æ–∫–µ–Ω–∞:

```bash
kubectl create secret generic telegram-bot-token \
  --from-literal=TELEGRAM_BOT_TOKEN='8326941950:AAHxjtILMo9qgPjm1Ii8CSsIZMLSp3B2oVE'
```

### 3.2 –î–µ–ø–ª–æ–π –±–æ—Ç–∞:

```bash
kubectl apply -f k8s/bot-deployment.yaml
```

### 3.3 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–æ–≤
kubectl get pods | grep bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
kubectl logs -f deployment/telegram-bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
kubectl get svc telegram-bot-service
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
NAME                           READY   STATUS    RESTARTS   AGE
telegram-bot-xxxxxxxxxx-xxxxx  1/1     Running   0          30s
```

---

## üîç –®–ê–ì 4: API –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### 4.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ API –±–æ—Ç–∞ (Telegram API):

```bash
curl -X POST "https://api.telegram.org/bot8326941950:AAHxjtILMo9qgPjm1Ii8CSsIZMLSp3B2oVE/getMe"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "ok": true,
  "result": {
    "id": 8326941950,
    "is_bot": true,
    "first_name": "Digital Twin Bot",
    "username": "digitaltwin2025_bot"
  }
}
```

### 4.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook endpoints (FastAPI):

```bash
# Health check
curl http://localhost:8000/health

# Webhook endpoint (–ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞)
curl http://localhost:8000/webhook/telegram
```

---

## üõ† –®–ê–ì 5: –ù–ê–°–¢–†–û–ô–ö–ê WEBHOOK (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 5.1 –î–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook:

```bash
curl -X POST "https://api.telegram.org/bot8326941950:AAHxjtILMo9qgPjm1Ii8CSsIZMLSp3B2oVE/setWebhook" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://your-domain.com/webhook/telegram",
    "allowed_updates": ["message", "callback_query"]
  }'
```

### 5.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook:

```bash
curl "https://api.telegram.org/bot8326941950:AAHxjtILMo9qgPjm1Ii8CSsIZMLSp3B2oVE/getWebhookInfo"
```

---

## üìä –®–ê–ì 6: –ú–û–ù–ò–¢–û–†–ò–ù–ì

### 6.1 –õ–æ–≥–∏ –±–æ—Ç–∞:

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
tail -f bot.log

# Kubernetes
kubectl logs -f deployment/telegram-bot --tail=100
```

### 6.2 –ú–µ—Ç—Ä–∏–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ API
curl http://localhost:8000/status
```

---

## ‚ö†Ô∏è TROUBLESHOOTING

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω:
   ```bash
   curl "https://api.telegram.org/bot8326941950:AAHxjtILMo9qgPjm1Ii8CSsIZMLSp3B2oVE/getMe"
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   kubectl logs deployment/telegram-bot
   ```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç:
   ```bash
   kubectl rollout restart deployment/telegram-bot
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ n8n

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ NBN_WEBHOOK_BASE –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ n8n workflow –∞–∫—Ç–∏–≤–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å

### –ü—Ä–æ–±–ª–µ–º–∞: Commands –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏—è:**
1. –ü–µ—Ä–µ–æ—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç —Å –±–æ—Ç–æ–º
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–∞–Ω–¥ –≤ @BotFather

---

## ‚úÖ CHECKLIST –§–ò–ù–ê–õ–¨–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- [ ] `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] `/help` - –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] `/status` - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω

### AI —Ñ—É–Ω–∫—Ü–∏–∏:
- [ ] `/ask <–≤–æ–ø—Ä–æ—Å>` - –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç Perplexity
- [ ] `/analyze` - –î–Ω–µ–≤–Ω–æ–π –∞–Ω–∞–ª–∏–∑ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
- [ ] `/report` - –ü–æ—á–∞—Å–æ–≤–æ–π –æ—Ç—á–µ—Ç –ø–æ–ª—É—á–µ–Ω

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- [ ] –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ - –ü–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- [ ] –ü—É—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å `/ask` - –ó–∞–ø—Ä–æ—Å —É—Ç–æ—á–Ω–µ–Ω–∏—è
- [ ] –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å n8n - –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

### Production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:
- [ ] Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Kubernetes deployment —Å—Ç–∞–±–∏–ª–µ–Ω
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–°–µ–π—á–∞—Å (–î–µ–∫–∞–±—Ä—å 8, 09:00 –ú–°–ö):**
   - ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤ @BotFather
   - ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã

2. **–ë–ª–∏–∂–∞–π—à–∏–µ —á–∞—Å—ã:**
   - Deploy –≤ Kubernetes
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook
   - –ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

3. **–≠—Ç–∞ –Ω–µ–¥–µ–ª—è:**
   - –ü–æ–¥–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –°–°–´–õ–ö–ò

- **–ë–æ—Ç:** [@digitaltwin2025_bot](https://t.me/digitaltwin2025_bot)
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** [github.com/vik9541/super-brain-digital-twin](https://github.com/vik9541/super-brain-digital-twin)
- **n8n Webhook:** `https://lavrentev.app.n8n.cloud/webhook`

---

**–ê–≤—Ç–æ—Ä:** Comet AI Assistant  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 8 –¥–µ–∫–∞–±—Ä—è 2025, 09:00 –ú–°–ö  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** Production Ready ‚úÖ
