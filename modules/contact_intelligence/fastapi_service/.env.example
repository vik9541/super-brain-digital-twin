# ============================================
# CONTACT INTELLIGENCE MODULE - ENV TEMPLATE
# ============================================
# Скопируйте этот файл в .env и заполните реальными значениями
# НИКОГДА не коммитьте .env в Git!
# ============================================

# === APPLICATION SETTINGS ===
APP_NAME="Contact Intelligence Service"
APP_VERSION="1.0.0"
ENVIRONMENT="production"  # development, staging, production
DEBUG=false
LOG_LEVEL="INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# === SERVER CONFIGURATION ===
HOST="0.0.0.0"
PORT=8000
WORKERS=4
RELOAD=false

# === SUPABASE DATABASE ===
SUPABASE_URL="https://lvixtpatqrtuwnygtpjx.supabase.co"
SUPABASE_KEY="your_supabase_anon_key_here"
SUPABASE_SERVICE_ROLE_KEY="your_supabase_service_role_key_here"
DATABASE_SCHEMA="public"

# === ENCRYPTION (CRITICAL!) ===
# Сгенерируйте: openssl rand -base64 32
CONTACT_ENCRYPTION_KEY="your_base64_encryption_key_here_REPLACE_ME"
ENCRYPTION_ALGORITHM="AES-256-GCM"

# === OPENAI API ===
OPENAI_API_KEY="sk-your_openai_api_key_here"
OPENAI_MODEL="gpt-4o-mini"  # gpt-4o-mini, gpt-4, gpt-3.5-turbo
OPENAI_TEMPERATURE=0.3
OPENAI_MAX_TOKENS=1000

# === LANGCHAIN ===
LANGCHAIN_TRACING_V2=false
LANGCHAIN_API_KEY=""

# === VECTOR DATABASE (pgvector) ===
VECTOR_DIMENSION=1536  # OpenAI embeddings dimension
VECTOR_SIMILARITY_THRESHOLD=0.7
EMBEDDING_MODEL="text-embedding-ada-002"

# === TELEGRAM BOT ===
TELEGRAM_BOT_TOKEN="your_telegram_bot_token_here"
TELEGRAM_BOT_USERNAME="your_bot_username"
TELEGRAM_WEBHOOK_URL="https://97v.ru/api/v1/contact/telegram/webhook"
TELEGRAM_WEBHOOK_SECRET="your_webhook_secret_token"

# === API AUTHENTICATION ===
API_SECRET_KEY="your_fastapi_secret_key_here_REPLACE_ME"
API_ALGORITHM="HS256"
ACCESS_TOKEN_EXPIRE_MINUTES=30

# === REDIS (optional, для кэширования) ===
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=""
REDIS_TTL=3600

# === CELERY (optional, для фоновых задач) ===
CELERY_BROKER_URL="redis://localhost:6379/1"
CELERY_RESULT_BACKEND="redis://localhost:6379/2"

# === MONITORING & LOGGING ===
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
SENTRY_DSN=""  # optional
STRUCTLOG_FORMAT="json"  # json, console

# === CONTACT INTELLIGENCE SETTINGS ===
AUTO_RESPOND_ENABLED=false
SENTIMENT_ANALYSIS_ENABLED=true
URGENCY_DETECTION_ENABLED=true
CONTEXT_WINDOW_DAYS=90  # История для анализа
MIN_MESSAGE_LENGTH=3
MAX_MESSAGE_LENGTH=10000

# === RATE LIMITING ===
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# === CORS (Cross-Origin Resource Sharing) ===
ALLOWED_ORIGINS="https://97v.ru,https://lavrentev.app.n8n.cloud"
ALLOWED_METHODS="GET,POST,PUT,DELETE"
ALLOWED_HEADERS="*"

# === BACKUP & RECOVERY ===
BACKUP_ENABLED=true
BACKUP_INTERVAL_HOURS=24
BACKUP_RETENTION_DAYS=30

# ============================================
# ИНСТРУКЦИЯ ПО ЗАПОЛНЕНИЮ:
# ============================================
#
# 1. SUPABASE:
#    - Откройте https://app.supabase.com/project/lvixtpatqrtuwnygtpjx/settings/api
#    - Скопируйте "anon public" ключ в SUPABASE_KEY
#    - Скопируйте "service_role" ключ в SUPABASE_SERVICE_ROLE_KEY
#
# 2. ENCRYPTION KEY (КРИТИЧНО!):
#    Выполните в терминале:
#    openssl rand -base64 32
#    Результат вставьте в CONTACT_ENCRYPTION_KEY
#    ⚠️ НИКОГДА НЕ ТЕРЯЙТЕ ЭТОТ КЛЮЧ! Без него данные не расшифровать.
#
# 3. OPENAI API KEY:
#    - Откройте https://platform.openai.com/api-keys
#    - Создайте новый ключ
#    - Вставьте в OPENAI_API_KEY
#
# 4. TELEGRAM BOT:
#    - Напишите @BotFather в Telegram
#    - Создайте нового бота командой /newbot
#    - Скопируйте токен в TELEGRAM_BOT_TOKEN
#
# 5. API SECRET KEY:
#    Выполните в Python:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"
#    Результат вставьте в API_SECRET_KEY
#
# 6. После заполнения переименуйте файл:
#    cp .env.example .env
#
# 7. Добавьте .env в .gitignore:
#    echo ".env" >> .gitignore
#
# ============================================
